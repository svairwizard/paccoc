function t_customMask__caret(e,t,n){var a;if(e&&"none"!==e.style.display)return"number"==typeof t?(n="number"==typeof n?n:t,e.setSelectionRange?e.setSelectionRange(t,n):e.createTextRange&&((a=e.createTextRange()).collapse(!0),a.moveEnd("character",n),a.moveStart("character",t),a.select()),e):(e.setSelectionRange?(t=e.selectionStart,n=e.selectionEnd):document.selection&&document.selection.createRange&&(n=(t=0-(a=document.selection.createRange()).duplicate().moveStart("character",-1e5))+a.text.length),{begin:t,end:n})}function t_customMask__unmask(e){return t_triggerEvent(e,"unmask")}function t_customMask__mask(e,t,n){var a,i=[],r=[],o,u=null,s,c,l;if(!t&&e){var d=window.tildaCustomMaskSetting.defaultSetting.dataName;return d?d():void 0}n=Object.assign({},{autoclear:window.tildaCustomMaskSetting.defaultSetting.autoclear,placeholder:window.tildaCustomMaskSetting.defaultSetting.placeholder,completed:null},n),a=window.tildaCustomMaskSetting.defaultSetting.definitions,o=c=t.length,r=(t=String(t)).split("");for(var v=0;v<r.length;v++){var f=r[v];"?"===f?(c--,o=v):a[f]?(i.push(new RegExp(a[f])),null===u&&(u=i.length-1),v<o&&(s=i.length-1)):i.push(null)}for(var m=[],v=0;v<r.length;v++){var g=r[v];"?"!==g&&(a[g]?m.push(p(v)):m.push(g))}var _=m.join(""),h=e.value;function p(e){return e<n.placeholder.length?n.placeholder.charAt(e):n.placeholder.charAt(0)}function k(){if(n.completed){for(var t=u;t<=s;t++)if(i[t]&&m[t]===p(t))return;n.completed=e}}function w(e){for(;++e<c&&!i[e];);return e}function E(e){for(;--e>=0&&!i[e];);return e}function b(t,n){var a=w(n);if(!(t<0)){for(var r=t;r<c;r++)if(i[r]){if(!(a<c&&i[r].test(m[a])))break;m[r]=m[a],m[a]=p(a),a=w(a)}T(),t_customMask__caret(e,Math.max(u,t))}}function M(e){for(var t=p(e),n,a,r=e;r<c;r++)if(i[r]){if(n=w(r),a=m[r],m[r]=t,!(n<c&&i[n].test(a)))break;t=a}}function S(){var t=e.value,n=t_customMask__caret(e),a=function(){t_customMask__caret(e,n.begin,n.begin)};if(l&&l.length&&l.length>t.length){for(var r=j(!0),o=n.end;o>0&&!i[o-1];)o--;0===o&&(o=r),n.begin=o,setTimeout((function(){a(),k()}),0)}else n.begin=j(!0),setTimeout((function(){a(),k()}),0);l=e.value}function y(){j(),e.value!=h&&e.change&&e.change(),!e.value&&e.classList.contains("t-input_has-content")&&e.classList.remove("t-input_has-content")}function L(t){if(!e.readOnly){var n=(t=t||window.event).keyCode||t.which,a,i,r;l=e.value,8===n||46===n||window.tildaCustomMaskSetting.iPhone&&127===n?(i=(a=t_customMask__caret(e)).begin,(r=a.end)-i==0&&(i=46!==n?E(i):r=w(i-1),r=46===n?w(r):r),O(i,r),b(i,r-1),t.preventDefault?t.preventDefault():t.returnValue=!1):13===n?y():27===n&&(e.value=h,t_customMask__caret(e,0,j()),t.preventDefault?t.preventDefault():t.returnValue=!1)}}function C(t){if(!e.readOnly){var n=(t=t||window.event).keyCode||t.which,a=t_customMask__caret(e),r,o,u;if(!(17===n||18===n||91===n||93===n||n<32)&&n&&13!==n){if(a.end-a.begin!=0&&(O(a.begin,a.end),b(a.begin,a.end-1)),(r=w(a.begin-1))<c&&(o=String.fromCharCode(n),i[r].test(o))){var l;if(M(r),m[r]=o,T(),u=w(r),window.tildaCustomMaskSetting.android)setTimeout((function(){t_customMask__caret(e,u)}),0);else t_customMask__caret(e,u);a.begin<=s&&k()}t.preventDefault?t.preventDefault():t.returnValue=!1}}}function O(e,t){for(var n=e;n<t&&n<c;n++)i[n]&&(m[n]=p(n))}function T(){e.value=m.join("")}function j(t){for(var a=e.value,r=-1,s=0,l,d=0;d<c;d++)if(i[d]){for(m[d]=p(d);s++<a.length;)if(l=a.charAt(s-1),i[d].test(l)){m[d]=l,r=d;break}if(s>a.length){O(d+1,c);break}}else m[d]===a.charAt(s)&&s++,d<o&&(r=d);return t?T():r+1<o?n.autoclear||m.join("")===_?(e.value&&(e.value=""),O(0,c)):T():(T(),e.value=e.value.substring(0,r+1)),o?d:u}function x(){if(!e.readOnly){clearTimeout(window.tildaCustomMaskSetting.caretTimeoutId),h=e.value;var n=j();window.tildaCustomMaskSetting.caretTimeoutId=setTimeout((function(){T(),n==t.replace("?","").length?t_customMask__caret(e,0,n):setTimeout((function(){t_customMask__caret(e,n)}),50)}),10)}}function A(){if(!e.readOnly){if(0===e.getAttribute("data-tilda-mask").indexOf("+7")){var t=e.value.replace(/\D/g,"");0===t.indexOf("78")&&(e.value=t.substring(2)),0!==t.indexOf("8")&&0!==t.indexOf("7")||(e.value=t.substring(1))}setTimeout((function(){var t=j(!0);t_customMask__caret(e,t),k()}),0)}}function R(){for(var e=document.querySelectorAll(".js-tilda-mask"),t=0;t<e.length;t++){var n=e[t];t_removeEventListener(n,D,x),t_removeEventListener(n,I,y),t_removeEventListener(n,"keydown",L),t_removeEventListener(n,"keypress",C),t_removeEventListener(n,"input",A),t_removeEventListener(n,"paste",A),t_removeEventListener(n,"unmask",R)}}var D="focus",I="blur";document.addEventListener||(D="focusin",I="focusout"),t_addEventListener(e,D,x),t_addEventListener(e,I,y),t_addEventListener(e,"paste",A),t_addEventListener(e,"unmask",R,{once:!0}),window.tildaCustomMaskSetting.chrome&&window.tildaCustomMaskSetting.android?(t_removeEventListener(e,"input",S),t_addEventListener(e,"input",S)):(t_addEventListener(e,"input",A),t_addEventListener(e,"keydown",L),t_addEventListener(e,"keypress",C)),j()}function t_triggerEvent(e,t){var n;document.createEvent?(n=document.createEvent("HTMLEvents")).initEvent(t,!0,!1):document.createEventObject&&((n=document.createEventObject()).eventType=t),n.eventName=t,e.dispatchEvent?e.dispatchEvent(n):e.fireEvent?e.fireEvent("on"+n.eventType,n):e[t]?e[t]():e["on"+t]&&e["on"+t]()}"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}),function(){var e=navigator.userAgent;window.tildaCustomMaskSetting={iPhone:/iphone/i.test(e),chrome:/chrome/i.test(e),android:/android/i.test(e),caretTimeoutId:0,defaultSetting:{definitions:{9:"[0-9]",a:"[A-Za-z]","а":"[А-Яа-яЁё]","*":"[A-Za-zА-Яа-яЁё0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"}}}();